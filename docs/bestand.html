<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="de" xml:lang="de"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.57">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">

<meta name="author" content="Thomas Gerdes ORCID">

<title>Bestand – MPI-Bibliothek</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "Keine Treffer",
    "search-matching-documents-text": "Treffer",
    "search-copy-link-title": "Link in die Suche kopieren",
    "search-hide-matches-text": "Zusätzliche Treffer verbergen",
    "search-more-match-text": "weitere Treffer in diesem Dokument",
    "search-more-matches-text": "weitere Treffer in diesem Dokument",
    "search-clear-button-title": "Zurücksetzen",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Abbrechen",
    "search-submit-button-title": "Abschicken",
    "search-label": "Suchen"
  }
}</script>
<meta name="author" content="Thomas Gerdes">
<meta name="description" content="Interactive dashboard for MPI library statistics and analysis">
<meta name="keywords" content="library, statistics, dashboard, acquisitions, collection, MPI">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<title>MPI-Bibliothek</title>
<meta name="author" content="Thomas Gerdes">
<meta name="description" content="Comprehensive collection analysis for MPI library including subject distribution">
<meta name="keywords" content="library, collection, subjects, statistics, MPI, print books, distribution">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<script src="https://cdnjs.cloudflare.com/ajax/libs/Chart.js/3.9.1/chart.min.js"></script>
<script src="shared/data.js"></script>
<script src="shared/functions.js"></script>


<link rel="stylesheet" href="shared/styles.css">
</head>

<body class="floating nav-fixed">

<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">MPI-Bibliothek</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Suchen"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Navigation umschalten" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Einleitung</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./bestand.html" aria-current="page"> 
<span class="menu-text">Bestand</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./erwerbungen.html"> 
<span class="menu-text">Erwerbungen</span></a>
  </li>  
</ul>
            <ul class="navbar-nav navbar-nav-scroll ms-auto">
  <li class="nav-item compact">
    <a class="nav-link" href="https://github.com/thomasgerdes/library-statistics"> <i class="bi bi-github" role="img" aria-label="GitHub Repository">
</i> 
<span class="menu-text"></span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
</header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-columns page-rows-contents page-layout-full page-navbar">
<!-- sidebar -->
  <nav id="quarto-sidebar" class="sidebar collapse collapse-horizontal quarto-sidebar-collapse-item sidebar-navigation floating overflow-auto">
    <nav id="TOC" role="doc-toc" class="toc-active">
    <h2 id="toc-title">Auf dieser Seite</h2>
   
  <ul>
  <li><a href="#bestandsentwicklung-2000-2024-print-bücher" id="toc-bestandsentwicklung-2000-2024-print-bücher" class="nav-link active" data-scroll-target="#bestandsentwicklung-2000-2024-print-bücher">Bestandsentwicklung 2000-2024 (Print-Bücher)</a></li>
  <li><a href="#bestandsverteilung-nach-fachgebieten-print-bücher" id="toc-bestandsverteilung-nach-fachgebieten-print-bücher" class="nav-link" data-scroll-target="#bestandsverteilung-nach-fachgebieten-print-bücher">Bestandsverteilung nach Fachgebieten (Print-Bücher)</a></li>
  <li><a href="#bestandsverteilung-nach-fachgebieten-ebooks" id="toc-bestandsverteilung-nach-fachgebieten-ebooks" class="nav-link" data-scroll-target="#bestandsverteilung-nach-fachgebieten-ebooks">Bestandsverteilung nach Fachgebieten (Ebooks)</a></li>
  <li><a href="#gesamtbestand" id="toc-gesamtbestand" class="nav-link" data-scroll-target="#gesamtbestand">Gesamtbestand</a></li>
  </ul>
</nav>
</nav>
<div id="quarto-sidebar-glass" class="quarto-sidebar-collapse-item" data-bs-toggle="collapse" data-bs-target=".quarto-sidebar-collapse-item"></div>
<!-- margin-sidebar -->
    <div id="quarto-margin-sidebar" class="sidebar margin-sidebar zindex-bottom">
    </div>
<!-- main -->
<main class="content column-page-right" id="quarto-document-content">

<header id="title-block-header" class="quarto-title-block default">
<div class="quarto-title">
<h1 class="title">Bestand</h1>
<p class="subtitle lead">Bestandsanalyse und Fachgebietsverteilung</p>
</div>



<div class="quarto-title-meta column-page-right">

    <div>
    <div class="quarto-title-meta-heading">Autor:in</div>
    <div class="quarto-title-meta-contents">
             <p>Thomas Gerdes <a href="https://orcid.org/0000-0001-8524-5987" target="_blank"><img src="https://orcid.org/sites/default/files/images/orcid_16x16.png" class="img-fluid" alt="ORCID"></a> </p>
          </div>
  </div>
    
    <div>
    <div class="quarto-title-meta-heading">Veröffentlichungsdatum</div>
    <div class="quarto-title-meta-contents">
      <p class="date">15. August 2025</p>
    </div>
  </div>
  
    
  </div>
  


</header>


<style>
.quarto-container {
  max-width: 1400px !important;
}
body {
  margin: 0 20px;
}

.dashboard-nav {
  background: #f8f9fa;
  padding: 15px;
  border-radius: 8px;
  margin: 20px 0;
  text-align: center;
}

.dashboard-nav a {
  display: inline-block;
  padding: 10px 20px;
  margin: 0 5px;
  background: #007bff;
  color: white;
  text-decoration: none;
  border-radius: 5px;
  transition: background-color 0.2s ease;
}

.dashboard-nav a:hover {
  background: #0056b3;
  color: white;
}

.dashboard-nav a.active {
  background: #28a745;
}

.info-box-container {
  display: flex;
  flex-wrap: wrap;
  justify-content: center;
  gap: 10px;
}

.info-box {
  background: #f8f9fa;
  padding: 12px;
  border-radius: 6px;
  text-align: center;
  flex: 1 1 200px;
  min-width: 200px;
  max-width: 250px;
}

@media (max-width: 768px) {
  .info-box {
    flex: 1 1 calc(50% - 5px);
    min-width: calc(50% - 5px);
    max-width: calc(50% - 5px);
  }
}

@media (max-width: 480px) {
  .info-box {
    flex: 1 1 100%;
    min-width: 100%;
    max-width: 100%;
  }
}

.info-box-value {
  font-size: 20px;
  font-weight: bold;
}

.info-box-label {
  font-size: 12px;
  color: #666;
  margin-top: 3px;
}

.info-box.blue { border-left: 3px solid #007bff; }
.info-box.blue .info-box-value { color: #007bff; }
.info-box.gray { border-left: 3px solid #6c757d; }
.info-box.gray .info-box-value { color: #6c757d; }
.info-box.green { border-left: 3px solid #28a745; }
.info-box.green .info-box-value { color: #28a745; }
.info-box.red { border-left: 3px solid #dc3545; }
.info-box.red .info-box-value { color: #dc3545; }

.dashboard-button {
  padding: 6px 12px;
  border: none;
  border-radius: 4px;
  color: white;
  cursor: pointer;
  font-size: 12px;
  transition: background-color 0.2s ease;
}

.dashboard-button:hover {
  opacity: 0.9;
}

.dashboard-button:focus {
  outline: 2px solid #000;
  outline-offset: 2px;
}

.chart-container {
  background: white;
  padding: 20px;
  margin: 30px 0;
  border-radius: 8px;
  box-shadow: 0 2px 8px rgba(0,0,0,0.1);
}

.chart-title {
  color: #333;
  text-align: center;
  margin: 10px 0 5px 0;
  font-size: 24px;
}
</style>
<div style="height: 40px;">

</div>
<section id="bestandsentwicklung-2000-2024-print-bücher" class="level2">
<h2 class="anchored" data-anchor-id="bestandsentwicklung-2000-2024-print-bücher">Bestandsentwicklung 2000-2024 (Print-Bücher)</h2>
<div class="chart-container">

  <div class="info-box-container" style="margin: 15px 0;">
  <div class="info-box blue">
    <div class="info-box-value" id="currentStockPrint" aria-live="polite">-</div>
    <div class="info-box-label">Bestand 31.12.2024</div>
  </div>
</div>

  <div style="margin: 15px 0; display: flex; gap: 8px; justify-content: center;">
    <button id="lineBtnStock" onclick="changeChartTypeStock('line')" aria-label="Wechsel zu Liniendiagramm für Bestandsentwicklung" class="dashboard-button" style="background: #28a745;">Liniendiagramm</button>
    <button id="barBtnStock" onclick="changeChartTypeStock('bar')" aria-label="Wechsel zu Balkendiagramm für Bestandsentwicklung" class="dashboard-button" style="background: #007bff;">Balkendiagramm</button>
    <button onclick="downloadChartStock()" aria-label="Diagramm der Bestandsentwicklung als PNG-Datei herunterladen" class="dashboard-button" style="background: #28a745;">PNG Download</button>
  </div>

  <div style="position: relative; height: 600px; margin: 10px 0;">
    <canvas id="stockChart" role="img" aria-label="Diagramm der Bestandsentwicklung Print-Bücher von 2000 bis 2024"></canvas>
  </div>
</div>

<p>Im Jahr 2008 wurden aus dem Bestand des MPI für Geschichte 8.096 Print-Bücher in die Bibliothek des MPI-MMG übernommen. Das entspricht ca. 7 Prozent des vormaligen Gestamtbestands.</p>

<details id="detailsStock">
<summary>📊 Detaildaten zur Bestandsentwicklung (Print-Bücher)</summary>
<div class="details-content">
</div>
</details>
<div style="height: 40px;">

</div>
<hr>
</section>
<section id="bestandsverteilung-nach-fachgebieten-print-bücher" class="level2">
<h2 class="anchored" data-anchor-id="bestandsverteilung-nach-fachgebieten-print-bücher">Bestandsverteilung nach Fachgebieten (Print-Bücher)</h2>
<div class="chart-container">
  
  <div style="display: flex; justify-content: center; margin: 15px 0;">
    <div class="info-box blue" style="flex: none;">
      <div class="info-box-value" id="totalBooks" aria-live="polite">-</div>
      <div class="info-box-label">Bestand 15.08.2025</div>
    </div>
  </div>

  <div style="margin: 15px 0; display: flex; gap: 8px; justify-content: center;">
    <button id="pieBtn2" onclick="changeChartType2('pie')" aria-label="Wechsel zu Kreisdiagramm für Bestandsverteilung" class="dashboard-button" style="background: #28a745;">Kreisdiagramm</button>
    <button id="barBtn2" onclick="changeChartType2('bar')" aria-label="Wechsel zu Balkendiagramm für Bestandsverteilung" class="dashboard-button" style="background: #007bff;">Balkendiagramm</button>
    <button onclick="downloadChart2()" aria-label="Diagramm der Bestandsverteilung als PNG-Datei herunterladen" class="dashboard-button" style="background: #28a745;">PNG Download</button>
  </div>

  <div style="position: relative; height: 700px; margin: 10px 0;">
    <canvas id="subjectChart" role="img" aria-label="Diagramm der Bestandsverteilung nach Fachgebieten"></canvas>
  </div>
</div>

<details id="details2">
<summary>📋 Detaildaten zur Bestandsaufschlüsselung (Print)</summary>
<div class="details-content">
</div>
</details>
<div style="height: 40px;">

</div>
<hr>
</section>
<section id="bestandsverteilung-nach-fachgebieten-ebooks" class="level2">
<h2 class="anchored" data-anchor-id="bestandsverteilung-nach-fachgebieten-ebooks">Bestandsverteilung nach Fachgebieten (Ebooks)</h2>
<p>
Die fachliche Verteilung der Ebooks lässt sich aus den Daten nicht direkt ermitteln, da Ebooks im Gegensatz zu gedruckten Büchern keine fachgebietsspezifischen Signaturen erhalten. Die Erwerbungshistorie deutet jedoch darauf hin, dass die thematische Aufteilung der Ebooks weitgehend der des Printbestands entspricht und somit ebenfalls einen klaren Schwerpunkt im Bereich der Sozial- und Kulturanthropologie aufweist.
</p>
<div style="height: 40px;">

</div>
<hr>
</section>
<section id="gesamtbestand" class="level2">
<h2 class="anchored" data-anchor-id="gesamtbestand">Gesamtbestand</h2>
<div class="chart-container">
  
  <div style="display: flex; justify-content: center; margin: 15px 0;">
    <div class="info-box blue" style="flex: none;">
      <div class="info-box-value" id="totalCollection" aria-live="polite">-</div>
      <div class="info-box-label">Gesamtbestand 15.08.2025</div>
    </div>
  </div>

  <div style="margin: 15px 0; display: flex; gap: 8px; justify-content: center;">
    <button id="pieBtn3" onclick="changeChartType3('pie')" aria-label="Wechsel zu Kreisdiagramm für Gesamtbestand" class="dashboard-button" style="background: #28a745;">Kreisdiagramm</button>
    <button id="barBtn3" onclick="changeChartType3('bar')" aria-label="Wechsel zu Balkendiagramm für Gesamtbestand" class="dashboard-button" style="background: #007bff;">Balkendiagramm</button>
    <button onclick="downloadChart3()" aria-label="Diagramm des Gesamtbestands als PNG-Datei herunterladen" class="dashboard-button" style="background: #28a745;">PNG Download</button>
  </div>

  <div style="position: relative; height: 500px; margin: 10px 0;">
    <canvas id="totalCollectionChart" role="img" aria-label="Diagramm des Gesamtbestands nach Medientypen"></canvas>
  </div>
</div>

<details id="details3">
<summary>📊 Detaildaten zur Bestandsaufschlüsselung</summary>
<div class="details-content">
</div>
</details>

<script>
let chartStock, chart2, chart3;
let currentChartTypeStock = 'line';
let currentChartType2 = 'pie';
let currentChartType3 = 'pie';

function initChartStock(type = 'line') {
  const ctx = document.getElementById('stockChart').getContext('2d');
  
  if (chartStock) { 
    chartStock.destroy(); 
  }

  currentChartTypeStock = type;
  updateActiveButtons(type, 'lineBtnStock', 'barBtnStock');

  const config = getStandardChartConfig(type, {
    labels: STOCK_DATA.map(d => d.year),
    datasets: [
      {
        label: 'Print-Bücher Bestand',
        data: STOCK_DATA.map(d => d.value),
        borderColor: '#007bff',
        backgroundColor: type === 'bar' ? '#007bff' : '#007bff20',
        borderWidth: 3,
        pointRadius: type === 'line' ? 4 : 0,
        fill: type === 'line'
      }
    ]
  }, {
    scales: {
      y: { 
        title: { display: true, text: 'Bestand (Anzahl Bücher)', font: { size: 12 } }
      }
    }
  });
  
  chartStock = new Chart(ctx, config);
  announceToScreenReader(`Bestandsentwicklungsdiagramm als ${type === 'line' ? 'Liniendiagramm' : 'Balkendiagramm'} geladen`);
}

function changeChartTypeStock(type) { 
  initChartStock(type); 
}

function downloadChartStock() {
  downloadChart(chartStock, 'bestandsentwicklung_2000-2024.png', 'Bestandsentwicklungsdiagramm');
}

function initChart2(type = 'pie') {
  const ctx = document.getElementById('subjectChart').getContext('2d');
  
  if (chart2) { 
    chart2.destroy(); 
  }

  currentChartType2 = type;
  updateActiveButtons(type, null, 'barBtn2', 'pieBtn2');

  const colors = [
    '#007bff', '#28a745', '#dc3545', '#ffc107', '#17a2b8', 
    '#6f42c1', '#fd7e14', '#20c997', '#6c757d', '#e83e8c',
    '#007bff80', '#28a74580', '#dc354580', '#ffc10780', '#17a2b880',
    '#6f42c180', '#fd7e1480', '#20c99780', '#007bff40', '#28a74540', '#dc354540'
  ];

  const sortedData = [...SUBJECT_DATA].sort((a, b) => b.count - a.count);
  
  const indexMapping = {};
  SUBJECT_DATA.forEach((item, index) => {
    indexMapping[`${item.signature}-${item.name}`] = index;
  });
  
  const colorsToUse = sortedData.map(item => {
    const originalIndex = indexMapping[`${item.signature}-${item.name}`];
    return colors[originalIndex];
  });

  const config = {
    type: type,
    data: {
      labels: sortedData.map(d => `${d.signature} - ${d.name}`),
      datasets: [{
        label: 'Anzahl Bücher',
        data: sortedData.map(d => d.count),
        backgroundColor: colorsToUse,
        borderColor: colorsToUse.map(color => color.replace('80', '').replace('40', '')),
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      accessibility: {
        announceNewData: {
          enabled: true
        }
      },
      layout: { padding: { bottom: type === 'bar' ? 60 : 20, left: 10, right: 10, top: 10 } },
      plugins: {
        legend: {
          display: type === 'pie',
          position: 'bottom',
          labels: { boxWidth: 12, padding: 8, font: { size: 9 }, usePointStyle: true }
        },
        tooltip: {
          callbacks: {
            title: context => null,
            label: context => {
              const count = type === 'bar' ? context.parsed.y : context.parsed;
              const percentage = ((count / TOTAL_BOOKS) * 100).toFixed(1);
              const item = sortedData[context.dataIndex];
              return `${item.signature} - ${item.name}: ${count.toLocaleString('de-DE')} (${percentage}%)`;
            }
          }
        }
      },
      scales: type === 'bar' ? {
        x: {
          title: { display: true, text: 'Signaturgruppe', font: { size: 12 } },
          ticks: {
            maxRotation: 45,
            minRotation: 45,
            font: { size: 8 },
            callback: (value, index) => {
              const item = sortedData[index];
              if (item) { 
                const label = `${item.signature} - ${item.name}`; 
                return label.length > 25 ? label.substr(0, 22) + '...' : label; 
              }
              return value;
            }
          }
        },
        y: { 
          title: { display: true, text: 'Anzahl Bücher', font: { size: 12 } }, 
          beginAtZero: true, 
          ticks: { font: { size: 10 } } 
        }
      } : {}
    }
  };
  
  chart2 = new Chart(ctx, config);
  announceToScreenReader(`Bestandsdiagramm als ${type === 'pie' ? 'Kreisdiagramm' : 'Balkendiagramm'} geladen`);
}

function changeChartType2(type) { 
  initChart2(type); 
}

function downloadChart2() {
  downloadChart(chart2, 'bestand_sachgruppen_2025.png', 'Bestandsdiagramm');
}

function initChart3(type = 'pie') {
  const ctx = document.getElementById('totalCollectionChart').getContext('2d');
  
  if (chart3) { 
    chart3.destroy(); 
  }

  currentChartType3 = type;
  updateActiveButtons(type, null, 'barBtn3', 'pieBtn3');

  const collectionColors = ['#007bff', '#28a745', '#17a2b8'];
  
  const collectionData = [
    { name: 'Print-Bücher', count: TOTAL_BOOKS }, 
    { name: 'Ebooks', count: TOTAL_EBOOKS },
    ...OTHER_MEDIA_DATA
  ];

  const dataToUse = type === 'bar' ? 
    [...collectionData].sort((a, b) => b.count - a.count) : 
    collectionData;

  const config = {
    type: type,
    data: {
      labels: dataToUse.map(d => d.name),
      datasets: [{
        label: 'Anzahl Medien',
        data: dataToUse.map(d => d.count),
        backgroundColor: collectionColors,
        borderColor: collectionColors,
        borderWidth: 1
      }]
    },
    options: {
      responsive: true,
      maintainAspectRatio: false,
      accessibility: {
        announceNewData: {
          enabled: true
        }
      },
      layout: { padding: { bottom: type === 'bar' ? 40 : 20, left: 10, right: 10, top: 10 } },
      plugins: {
        legend: {
          display: type === 'pie',
          position: 'bottom',
          labels: { boxWidth: 15, padding: 15, font: { size: 12 }, usePointStyle: true }
        },
        tooltip: {
          callbacks: {
            title: context => null,
            label: context => {
              const count = type === 'bar' ? context.parsed.y : context.parsed;
              const percentage = ((count / TOTAL_COLLECTION) * 100).toFixed(1);
              const item = dataToUse[context.dataIndex];
              return `${item.name}: ${count.toLocaleString('de-DE')} (${percentage}%)`;
            }
          }
        }
      },
      scales: type === 'bar' ? {
        x: { 
          title: { display: true, text: 'Medientyp', font: { size: 12 } }, 
          ticks: { font: { size: 11 } } 
        },
        y: { 
          title: { display: true, text: 'Anzahl Medien', font: { size: 12 } }, 
          beginAtZero: true, 
          ticks: { font: { size: 10 } } 
        }
      } : {}
    }
  };
  
  chart3 = new Chart(ctx, config);
  announceToScreenReader(`Gesamtbestandsdiagramm als ${type === 'pie' ? 'Kreisdiagramm' : 'Balkendiagramm'} geladen`);
}

function changeChartType3(type) { 
  initChart3(type); 
}

function downloadChart3() {
  downloadChart(chart3, 'gesamtbestand_2025.png', 'Gesamtbestandsdiagramm');
}

function updateStockStats() {
  document.getElementById('currentStockPrint').textContent = formatNumber(CURRENT_STOCK);
}

function updateSubjectStats() {
  document.getElementById('totalBooks').textContent = formatNumber(TOTAL_BOOKS);
}

function updateCollectionStats() {
  document.getElementById('totalCollection').textContent = formatNumber(TOTAL_COLLECTION);
}

function generateTableStock() {
  const columns = [
    { field: 'year', title: 'Jahr' },
    { field: 'value', title: 'Bestand Print-Bücher', formatter: formatNumber }
  ];
  return generateTable(STOCK_DATA, columns, {
    className: 'table table-striped table-hover',
    ariaLabel: 'Detaildaten der Bestandsentwicklung nach Jahren'
  });
}

function generateTable2() {
  const columns = [
    { field: 'signature', title: 'Signatur' },
    { field: 'name', title: 'Fachgebiet' },
    { field: 'count', title: 'Anzahl', formatter: formatNumber },
    { 
      field: 'count', 
      title: 'Anteil', 
      formatter: (value) => ((value / TOTAL_BOOKS) * 100).toFixed(1) + '%'
    }
  ];
  return generateTable(SUBJECT_DATA, columns, {
    sortBy: 'count',
    sortDesc: true,
    className: 'table table-striped table-hover',
    ariaLabel: 'Detaillierte Bestandsaufschlüsselung nach Fachgebieten'
  });
}

function generateTable3() {
  // Definiere die Daten hier lokal
  const collectionData = [
    { name: 'Print-Bücher', count: TOTAL_BOOKS }, 
    { name: 'Ebooks', count: TOTAL_EBOOKS },
    ...OTHER_MEDIA_DATA
  ];

  const columns = [
    { field: 'name', title: 'Medientyp' },
    { field: 'count', title: 'Anzahl', formatter: formatNumber },
    { 
      field: 'count', 
      title: 'Anteil', 
      formatter: (value) => ((value / TOTAL_COLLECTION) * 100).toFixed(1) + '%'
    }
  ];
  return generateTable(collectionData, columns, {
    className: 'table table-striped table-hover',
    ariaLabel: 'Gesamtbestand nach Medientypen'
  });
}

function initTables() {
  try {
    document.querySelector('#detailsStock .details-content').innerHTML = generateTableStock();
    document.querySelector('#details2 .details-content').innerHTML = generateTable2();
    document.querySelector('#details3 .details-content').innerHTML = generateTable3();
    console.log('📋 Collection tables initialized successfully');
  } catch (error) {
    console.error('Error initializing collection tables:', error);
  }
}

function initializeCollection() {
  try {
    console.log('🚀 Initializing Collection Dashboard...');
    
    updateStockStats();
    updateSubjectStats();
    updateCollectionStats();
    
    initChartStock();
    initChart2();
    initChart3();
    
    initTables();
    
    initDashboard([chartStock, chart2, chart3]);
    
    console.log('✅ Collection initialization complete');
    
  } catch (error) {
    console.error('❌ Collection initialization failed:', error);
    announceToScreenReader('Fehler beim Laden der Bestandsanalyse');
  }
}

if (document.readyState === 'loading') {
  document.addEventListener('DOMContentLoaded', initializeCollection);
} else {
  initializeCollection();
}

window.addEventListener('load', function() {
  if (!chartStock || !chart2 || !chart3) {
    console.log('🔄 Re-initializing collection charts...');
    initializeCollection();
  }
});
</script>


</section>

</main> <!-- /main -->
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Kopiert");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Kopiert");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->
<footer class="footer">
  <div class="nav-footer">
    <div class="nav-footer-left">
<p>© 2025 <a href="https://thomasgerdes.de" target="_blank">Thomas Gerdes</a></p>
</div>   
    <div class="nav-footer-center">
      &nbsp;
    </div>
    <div class="nav-footer-right">
      &nbsp;
    </div>
  </div>
</footer>




</body></html>